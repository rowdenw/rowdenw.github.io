---
output:
  md_document:
    variant: gfm
    preserve_yaml: TRUE
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding, output_dir = "../_drafts") })
author: "William C. Rowden"
date: "2021-03-21"
discussion_id: Profile-Agile-Consultans
excerpt: ""
layout: post
mermaid: false
tags:
  - growing up
title: Profile Agile Consultants
---

```{r setup, include=FALSE}
base_dir <- "~/Documents/GitHub/rowdenw.github.io" # i.e. where the jekyll blog is on the hard drive.
base_url <- "/" # keep as is
fig_path <- "images/" # customize to heart's content, I 'spose.

knitr::opts_knit$set(base.dir = base_dir, base.url = base_url)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.path = fig_path,
                      cache.path = '../_cache/',
                      message=FALSE, warning=FALSE,
                      cache = FALSE) # Change to TRUE for publication.
library(tidyverse)
library("ggthemes")
```

## Adults

```{r Cook-Greuter-Mixed-Adults, echo=FALSE}
path_CG_results <- file.path(base_dir, "_data", "Cook-Greuter-Results.csv")
results_df <- read.csv(path_CG_results, stringsAsFactors = FALSE)
mixed <- results_df %>% filter(Sample == 1)
joiner <- c("Enthusiast", "Operator", "Conformer", "Expert", "Achiever", "Catalyst",
            "Co-Creator", "Synergist")
ggplot(mixed, aes(x = Stage, y = Percentage)) + geom_point() +
  geom_line() +
  scale_x_continuous(labels = joiner, limits = c(2,9), n.breaks = 9) +
  scale_y_continuous() +
  theme_tufte()
```


## Consultants

```{r Cook-Greuter-Results, echo=FALSE}
consultants <- results_df %>% filter(Sample < 4)
ggplot(consultants, aes(x = Stage, y = Percentage, shape=factor(Sample))) + geom_point() +
  geom_line() +
  scale_x_continuous(labels = joiner, limits = c(2,9), n.breaks = 9) +
  scale_y_continuous() +
  theme_tufte() +
  labs(shape = "Sample")
```

## Agile Consultants

```{r Anonymize-Results, echo=FALSE}
path_source <- file.path(base_dir, "_data", "Source-GLP.csv")
profile_df <- read.csv(path_source, stringsAsFactors = FALSE)
profile_columns <- profile_df %>% select(Profile, Ogive, Modifier)
profile_columns %>% arrange(Ogive, Modifier)
```

```{r Distribute-Profiles, echo=FALSE}
consultant_team <- profile_df %>% filter(ACN == TRUE, Client == TRUE)
ggplot(consultant_team, aes(x = Ogive)) + geom_bar() +
  theme_tufte() +
  labs(x = "Stage")
# Bar charts can't have orange, green, and teal?
# + scale_color_manual(values = c("#FF8000", "#00FF00", "#008080"))
```

```{r Early, echo=FALSE}
early_profile <- profile_df[which.min(profile_df$Ogive + profile_df$Modifier), "Profile"]
path_stems <- file.path(base_dir, "_data", "Score-GLP.csv")
stems_df <- read.csv(path_stems, stringsAsFactors = FALSE)
stems_max <- stems_df[which.max(stems_df$Stems), "Stems"]
early <- stems_df %>% filter(Profile == early_profile)
ggplot(early, aes(x = Stage, y = Stems)) + geom_point() + geom_smooth() +
  scale_x_continuous(labels = joiner, limits = c(2,9), n.breaks = 9) +
  scale_y_continuous(limits = c(0,stems_max)) +
  theme_tufte()
```

```{r Late, echo=FALSE}
late_profile <- profile_df[which.max(profile_df$Ogive + profile_df$Modifier), "Profile"]
late <- stems_df %>% filter(Profile == late_profile)
ggplot(late, aes(x = Stage, y = Stems)) + geom_point() + geom_smooth() +
  scale_x_continuous(labels = joiner, limits = c(2,9), n.breaks = 9) +
  scale_y_continuous(limits = c(0,stems_max)) +
  theme_tufte()
```

```{r Early+Late, echo=FALSE}
early_late <- stems_df %>% filter(Profile %in% c(early_profile, late_profile))
ggplot(early_late, aes(x = Stage, y = Stems, color=Profile)) + geom_point() + geom_smooth() +
  scale_x_continuous(labels = joiner, limits = c(2,9), n.breaks = 9) +
  scale_y_continuous(limits = c(0,stems_max)) +
  theme_tufte()
```

```{r Score-Profile, echo=FALSE}
ggplot(profile_df, aes(x = factor(Initials), y = Ogive + Modifier)) + geom_point() +
  theme_tufte()
```

```{r Score-Stems, echo=FALSE}
ggplot(stems_df, aes(x = Stage, y = Stems)) + geom_point() + geom_smooth() +
  coord_cartesian(xlim=c(2,9), ylim=c(0,stems_max)) +
  facet_wrap( ~ Profile) +
  theme_tufte()
```

